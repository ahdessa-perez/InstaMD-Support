<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>InstaMD SUPPORT</title>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" />
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@7.12.15/dist/sweetalert2.all.min.js"></script>
    <style>
      .form-container {
        max-width: 600px;
        margin: auto;
        margin-top: 50px;
        padding: 20px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        background-color: #fff;
      }
      .logo {
        display: block;
        margin: 0 auto;
        width: 150px;
        height: auto;
      }
      .title {
        text-align: center;
        margin-top: 10px;
        font-size: 24px;
        font-weight: bold;
        margin-bottom: 30px;
      }

    </style>
  </head>
  <body class="bg-light">
    <div class="container">
      <div class="form-container">
        <img src="logo.jpg" alt="InstaMD Logo" class="logo" />
        <div class="title">InstaMD Support</div>
        
        <form id="dataForm">
          <div class="form-group">
            <label for="employeeName">Employee Name:</label>
            <select class="form-control" id="employeeName" name="employeeName" required>
              <option value="">Select</option>
              <option value="Jose">Jose</option>
              <option value="Pearly">Pearly</option>
              <option value="Micah">Micah</option>
              <option value="Mary">Mary</option>
              <option value="Emie">Emie</option>
              <option value="Viet">Viet</option>
            </select>
          </div>
          <div class="form-group">
            <label for="practice">Practice:</label>
            <select class="form-control" id="practice" name="practice" required>
              <option value="">Select</option>
              <option value="Dr. Manshadi">Dr. Manshadi</option>
              <option value="Dr. Ashok">Dr. Ashok</option>
              <option value="Dr. Reddy">Dr. Reddy</option>
              <option value="AllHomes/Dr Scott">AllHomes/Dr Scott</option>
              <option value="DKA">DKA</option>
              <option value="Dr. Jalli">Dr. Jalli</option>
              <option value="Prestige Health">Prestige Health</option>
              <option value="Dr. Waxali">Dr. Waxali</option>
              <option value="Dr. Vera">Dr. Vera</option>
              <option value="Dr. Jenny">Dr. Jenny</option>
              <option value="NNC">NNC</option>
              <option value="Dr. Balikian">Dr. Balikian</option>
              <option value="CKC">CKC</option>
              <option value="NEPHROPHILES">NEPHROPHILES</option>
              <option value="Dr. Chavez">Dr. Chavez</option>
              <option value="NAWNY">NAWNY</option>
              <option value="Dr. Batarse">Dr. Batarse</option>
              <option value="SNSC">SNSC</option>
              <option value="Dr Chirala">Dr Chirala</option>
              <option value="NTHMD">NTHMD</option>
              <option value="Tri Duong">Tri Duong</option>
              <option value="Dr. Dan">Dr. Dan</option>
            </select>
          </div>
          <div class="form-group">
            <label for="ticket">Ticket Number:</label>
            <input class="form-control" type="text" id="ticket" name="ticket" required />
          </div>
          <div class="form-group">
            <label for="patientName">Patient Name:</label>
            <input class="form-control" type="text" id="patientName" name="patientName" required />
          </div>
          <div class="form-group">
            <label for="status">Status:</label>
            <select class="form-control" id="status" name="status" required>
              <option value="">Select</option>
              <option value="solved">Solved</option>
              <option value="PENDING">PENDING</option>
              <option value="VM">VM</option>
              <option value="MONITOR">MONITOR</option>
              <option value="DEVICE REP.">DEVICE REP.</option>
              <option value="OPEN">OPEN</option>
              <option value="CALLBACK">CALLBACK</option>
            </select>
          </div>
          <div class="form-group">
            <label for="notes">Notes:</label>
            <textarea class="form-control" id="notes" name="notes" rows="4" required></textarea>
          </div>
          <button type="submit" class="btn btn-primary btn-block" id="submitButton">Submit</button>
        </form>
      </div>
    </div>

    <script>
        const scriptURL = "https://script.google.com/macros/s/AKfycbzwmB3sKb3hzwqoxuVavwFtCBkOrCfMKj0sXoCs_2-DxGoKYIB871JN-63q3HjL2h9AaQ/exec";
        const form = document.getElementById("dataForm");
        const submitButton = document.getElementById("submitButton");
      
        form.addEventListener("submit", (e) => {
          e.preventDefault(); 
          const formData = new FormData(form);
      
          submitButton.textContent = "Submitted";
          submitButton.disabled = true;
      
          fetch(scriptURL, { method: "POST", body: formData })
            .then((response) => {
              if (response.ok) {
                Swal.fire("Success!", "Submitted Successfully", "success");
      
                submitButton.textContent = "Submitted";
              } else {
                throw new Error("Failed to submit.");
              }
            })
            .catch((error) => {
              Swal.fire("Error!", "There was an issue submitting your data.", "error");
      
              submitButton.textContent = "Submit";
              submitButton.disabled = false;
            })
            .finally(() => {
              form.reset(); 
            });
        });
      </script>
  </body>
</html>
